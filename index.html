<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Curso BTC - Prototipo</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f4f4f4; }
        .container { max-width: 1200px; margin: auto; }
        .login { text-align: center; padding: 50px; background: white; border-radius: 10px; }
        .dashboard { display: none; }
        .section { margin: 20px 0; padding: 20px; background: white; border-radius: 10px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { padding: 10px; border: 1px solid #ddd; text-align: left; }
        #news-feed { list-style: none; padding: 0; }
        #news-feed li { margin: 10px 0; }
        .steps { display: none; }
        button { padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0056b3; }
    </style>
    <script src="https://widgets.coingecko.com/coingecko-coin-price-marquee-widget.js"></script>
    <script src="https://www.tradingview.com/embed-widget/advanced-chart/"></script>
</head>
<body>
    <div class="container">
        <!-- Página de Login (Portada) -->
        <div id="login" class="login">
            <h1>Bienvenido al Curso de BTC</h1>
            <p>Noticias Crypto en Tiempo Real:</p>
            <coingecko-coin-price-marquee-widget coin-ids="bitcoin,ethereum,ripple,solana" currency="usd" background-color="#ffffff" locale="en"></coingecko-coin-price-marquee-widget>
            
            <div class="section">
                <h2>Información sobre Bitcoin (Actualizada)</h2>
                <p id="btc-info">Cargando datos de BTC...</p>
            </div>
            
            <div class="section">
                <h2>Gráfico de Precios (TradingView)</h2>
                <div id="tradingview-widget" style="height: 400px;"></div>
            </div>
            
            <form id="login-form">
                <input type="email" placeholder="Email" required>
                <input type="password" placeholder="Contraseña" required>
                <button type="submit">Iniciar Sesión (Simulado Auth0)</button>
            </form>
        </div>
        
        <!-- Dashboard después de Login -->
        <div id="dashboard" class="dashboard">
            <h1>Dashboard Crypto</h1>
            
            <div class="section">
                <h2>Precios Principales Criptomonedas</h2>
                <table id="prices-table">
                    <thead><tr><th>Moneda</th><th>Precio (USD)</th><th>Cambio 24h</th></tr></thead>
                    <tbody></tbody>
                </table>
            </div>
            
            <div class="section">
                <h2>Noticias Crypto</h2>
                <ul id="news-feed"></ul>
            </div>
            
            <!-- Flujo de Pasos: Follows, Cuestionario, Link Telegram -->
            <div id="steps" class="steps">
                <h2>Paso 1: Sigue las Redes Sociales</h2>
                <label><input type="checkbox" id="follow1"> Sigue Twitter/X de BTC</label><br>
                <label><input type="checkbox" id="follow2"> Sigue Instagram de Crypto</label><br>
                <label><input type="checkbox" id="follow3"> Sigue YouTube de Trading</label><br>
                <button id="next-follow">Siguiente</button>
                
                <div id="quiz" style="display:none;">
                    <h2>Paso 2: Cuestionario</h2>
                    <p>1. ¿Qué es Bitcoin? <input type="text" id="q1"></p>
                    <p>2. ¿Quién creó BTC? <input type="text" id="q2"></p>
                    <p>3. ¿Qué es Blockchain? <input type="text" id="q3"></p>
                    <button id="submit-quiz">Finalizar</button>
                </div>
                
                <div id="telegram-link" style="display:none;">
                    <h2>¡Listo! Únete al Grupo de Telegram</h2>
                    <a href="https://t.me/tu_grupo_telegram" target="_blank">Ir al Curso en Telegram</a>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simular Login
        document.getElementById('login-form').addEventListener('submit', (e) => {
            e.preventDefault();
            document.getElementById('login').style.display = 'none';
            document.getElementById('dashboard').style.display = 'block';
            document.getElementById('steps').style.display = 'block';
            loadPrices();
            loadNews();
            loadBtcInfo();
            // Refrescar noticias cada 60 segundos
            setInterval(loadNews, 60000);
        });

        // Cargar Precios en Tiempo Real (CoinGecko API)
        function loadPrices() {
            fetch('https://api.coingecko.com/api/v3/coins/markets?vs_currency=usd&ids=bitcoin,ethereum,ripple,solana&order=market_cap_desc')
                .then(res => res.json())
                .then(data => {
                    const tbody = document.querySelector('#prices-table tbody');
                    tbody.innerHTML = '';
                    data.forEach(coin => {
                        const row = `<tr><td>${coin.name}</td><td>$${coin.current_price}</td><td>${coin.price_change_percentage_24h}%</td></tr>`;
                        tbody.innerHTML += row;
                    });
                });
            setTimeout(loadPrices, 30000); // Actualiza cada 30s
        }

        // Cargar Noticias en Tiempo Real (NewsAPI.org - Reemplaza con tu API key)
        function loadNews() {
            const apiKey = 'TU_API_KEY_AQUI'; // Obtén una gratis en https://newsapi.org/
            fetch(`https://newsapi.org/v2/everything?q=bitcoin OR crypto&sortBy=publishedAt&language=es&pageSize=10&apiKey=${apiKey}`)
                .then(res => res.json())
                .then(data => {
                    const feed = document.getElementById('news-feed');
                    feed.innerHTML = '';
                    if (data.articles && data.articles.length > 0) {
                        data.articles.forEach(article => {
                            const date = new Date(article.publishedAt).toLocaleString('es-ES');
                            feed.innerHTML += `<li><a href="${article.url}" target="_blank">${article.title}</a> - ${article.source.name} (${date})</li>`;
                        });
                    } else {
                        feed.innerHTML = '<li>No hay noticias disponibles en este momento.</li>';
                    }
                })
                .catch(err => {
                    console.error('Error fetching news:', err);
                    document.getElementById('news-feed').innerHTML = '<li>Error al cargar noticias. Verifica tu API key.</li>';
                });
        }

        // Info BTC
        function loadBtcInfo() {
            fetch('https://api.coingecko.com/api/v3/coins/bitcoin')
                .then(res => res.json())
                .then(data => {
                    document.getElementById('btc-info').innerHTML = `Precio: $${data.market_data.current_price.usd}<br>Market Cap: $${data.market_data.market_cap.usd}<br>Dominance: ${data.market_data.market_cap_change_percentage_24h_in_currency.usd}%`;
                });
        }

        // Gráfico TradingView
        new TradingView.widget({
            "container_id": "tradingview-widget",
            "width": "100%",
            "height": 400,
            "symbol": "BINANCE:BTCUSDT",
            "interval": "D",
            "timezone": "Etc/UTC",
            "theme": "light",
            "style": "1",
            "locale": "es",
            "toolbar_bg": "#f1f3f6",
            "enable_publishing": false,
            "allow_symbol_change": true,
            "studies": ["MACD"]
        });

        // Flujo de Pasos
        document.getElementById('next-follow').addEventListener('click', () => {
            if (document.querySelectorAll('input[type="checkbox"]:checked').length === 3) {
                document.getElementById('quiz').style.display = 'block';
            } else {
                alert('Debes seguir todas las redes.');
            }
        });

        document.getElementById('submit-quiz').addEventListener('click', () => {
            if (document.getElementById('q1').value && document.getElementById('q2').value && document.getElementById('q3').value) {
                document.getElementById('telegram-link').style.display = 'block';
            } else {
                alert('Responde todas las preguntas.');
            }
        });
    </script>
</body>
</html>
